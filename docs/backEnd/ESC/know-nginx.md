# nginx
Nginx（发音同engine x）是异步框架的网页伺服器，也可以用作反向代理、负载平衡器和HTTP缓存

## 入门
最早接触`nginx`的时候，当时还是个萌新，什么都不懂。当时使用`nginx`是为了部署一个`vue`项目，让其可以在局域网访问(ps: 同一个WIFI下的手机和电脑都可以访问)。也许有人就要问，vue不是支持局域网访问了吗？对，没错，现在是支持的。当时是vue比较早的版本，也许是vue不支持，亦或是我不会配置。  
当时使用`nginx`的时候，其实我只是使用者，并没有去学习。某位大神帮我配置的，让我去使用而已。  
真正开始接触`nginx`的时候，是在上家公司的时候。Boss要我通过`nginx`配置移动端和PC端自动跳转。这个功能对于当时的我,算是比较难的。然后从头开始看nginx文档，查资料，问大神，终于让我完成了这个功能。也随着这次经验，让我之后对`nginx`有了深厚的兴趣。

## 功能
### 反向代理
- 正向代理与反向代理
    - 正向代理  
    比如`VPN`， 国内并不能友好的自由上网。而VPN的作用就是通过一台可以访问外网的代理服务器，将外网网站的资源转换给你使用。简单来说，就是当你想要访问google时，命令你的代理服务器去访问google,然后代理服务器拿到资源后，将资源再转给你的电脑，这样你就可以访问google的页面了。

    - 反向代理
    其实就是跟`正向代理`相反。`正向代理`是代替客户端去访问服务器，而`反向代理`就是代替服务器去访问用户。

- 为什么要使用反向代理？
    - 保护原始服务器，所有的访问都需要通过代理服务器。
    - 缓存静态资源，加快网页请求
    - 负载均衡  
        `代理服务器`虽然只有一台，但`原始服务器`可以有多个了。比如`原始服务器`有A,B,C, 当你访问时，`代理服务器`检测到`原始服务器A`访问量过大，它就会去请求`原始服务器B`来获取资源，从而降低`原始服务器A`的压力。

### 网络限制
比如公司内网，不想让你访问某些网站，就可以通过nginx进行限制

### 跨域
虽说跨域现在已经是很常见的问题，解决起来也很方便。但`nginx`却提供了一种新思路.
```
    location ^~/api/ {
        rewrite ^/api/(.*)$ /$1 break;
        proxy_pass https://www.source.com/;
    }  
```
调用接口时，你首先访问`代理服务器`, `代理服务器改写你的请求`，让你的请求和`原始服务器`同源, 从而解决跨域问题。

### 适配PC端与移动端
这也是我痛苦很久才实现的功能，通过检查`user-agent`，判断去访问不同的`原始服务器`.
```
    location / {
        if ($http_user_agent ~* '(Android|webOS|iPhone|iPod|BlackBerry)') {
            set $request 'mobile';
        }
        if ($request = 'mobile') {
            rewrite ^.+ http://www.phone.com;
        }
    }  
```

> 除此之外，nginx还有很多功能。但操作起来相对比较繁琐，在这篇入门里讲，就不太合适了，留着后续讲解吧。



